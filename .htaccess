RewriteEngine On

RewriteCond %{QUERY_STRING} base64_encode.*\(.*\) [OR]
RewriteCond %{QUERY_STRING} (\<|%3C).*script.*(\>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} (\<|%3C).*iframe.*(\>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
RewriteRule ^(.*)$ error.php [F,L]

RewriteCond %{REQUEST_METHOD} ^(TRACE|TRACK)
RewriteRule .* - [F,L]

RewriteRule ([a-zA-Z0-9_-]+)\.php/ error.php [R]

RewriteRule ^home$ index.php
RewriteRule ^files/$ error.php?m=403

RewriteCond %{REQUEST_URI} ^(.*)datasets?(.*)
RewriteRule .* %1submissions%2 [R=301,L]

RewriteCond %{HTTPS} =on
RewriteRule (.*) http://%{HTTP_HOST}/$1 [R=301,L] 

RewriteRule submissions$ %{REQUEST_URI}/ [R,L]
RewriteRule submissions/?$ view.php?id=all
RewriteRule submissions/([0-9]+|all|mine)$ view.php?id=$1 [QSA]

RewriteRule ^([a-zA-Z0-9_-]+)(?!\.php)$ $1.php [L]
